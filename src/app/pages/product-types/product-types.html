<div class="product-types-container">
  <mat-card class="page-header">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>label</mat-icon>
        {{ getPageTitle() }}
      </mat-card-title>
    </mat-card-header>
    <mat-card-actions>
      <button mat-button color="accent" routerLink="/categories" *ngIf="categoryId">
        <mat-icon>arrow_back</mat-icon>
        Volver a Categor√≠as
      </button>
      <button mat-raised-button color="primary" [routerLink]="['/product-types/new', categoryId ? {categoryId: categoryId} : {}]" *ngIf="isLoggedIn()">
        <mat-icon>add</mat-icon>
        Nuevo Tipo
      </button>
    </mat-card-actions>
  </mat-card>

  <mat-card *ngIf="category" class="category-info-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon *ngIf="category.icon">{{ category.icon }}</mat-icon>
        {{ category.name }}
      </mat-card-title>
    </mat-card-header>
    <mat-card-content *ngIf="category.description">
      <p>{{ category.description }}</p>
    </mat-card-content>
  </mat-card>

  <mat-card *ngIf="loading" class="loading-card">
    <mat-card-content>
      <div class="loading-content">
        <mat-spinner diameter="40"></mat-spinner>
        <p>Cargando tipos de productos...</p>
      </div>
    </mat-card-content>
  </mat-card>

  <mat-card *ngIf="error" class="error-card">
    <mat-card-content>
      <div class="error-content">
        <mat-icon color="warn">error</mat-icon>
        <p>{{ error }}</p>
        <button mat-raised-button color="accent" (click)="loadProductTypes()">
          <mat-icon>refresh</mat-icon>
          Reintentar
        </button>
      </div>
    </mat-card-content>
  </mat-card>

  <div class="product-types-grid" *ngIf="!loading && !error && productTypes.length > 0">
    <mat-card class="product-type-card" *ngFor="let productType of productTypes">
      <mat-card-header>
        <mat-card-title>{{ productType.name }}</mat-card-title>
        <mat-card-subtitle>
          <div class="status-buttons">
            <button mat-mini-fab 
                    [color]="productType.isActive ? 'primary' : 'warn'"
                    class="status-button">
              <mat-icon>{{ productType.isActive ? 'check_circle' : 'cancel' }}</mat-icon>
            </button>
            <span class="status-text">{{ productType.isActive ? 'Activo' : 'Inactivo' }}</span>
            
            <button mat-mini-fab 
                    color="accent"
                    class="count-button">
              <mat-icon>inventory</mat-icon>
            </button>
            <span class="count-text">{{ getProductsCount(productType) }} productos</span>
          </div>
        </mat-card-subtitle>
      </mat-card-header>
      
      <mat-card-content>
        <p class="description" *ngIf="productType.description">{{ productType.description }}</p>
        
        <div class="specifications" *ngIf="productType.specifications">
          <h4>Especificaciones:</h4>
          <p>{{ productType.specifications }}</p>
        </div>
      </mat-card-content>
      
      <mat-card-actions *ngIf="isLoggedIn()" class="product-type-actions">
        <button mat-button color="primary" [routerLink]="['/product-types/edit', productType.id]">
          <mat-icon>edit</mat-icon>
          Editar
        </button>
        <button mat-button color="accent" [routerLink]="['/products', 'product-type', productType.id]">
          <mat-icon>inventory</mat-icon>
          Ver Productos
        </button>
        <button mat-button color="warn" (click)="deleteProductType(productType.id!)">
          <mat-icon>delete</mat-icon>
          Eliminar
        </button>
      </mat-card-actions>
    </mat-card>
  </div>

  <mat-card *ngIf="!loading && !error && productTypes.length === 0" class="empty-state">
    <mat-card-content>
      <div class="empty-content">
        <mat-icon>label_off</mat-icon>
        <h3>No hay tipos de productos disponibles</h3>
        <p>Comienza creando tu primer tipo de producto</p>
        <button mat-raised-button color="primary" [routerLink]="['/product-types/new', categoryId ? {categoryId: categoryId} : {}]" *ngIf="isLoggedIn()">
          <mat-icon>add</mat-icon>
          Crear Primer Tipo
        </button>
      </div>
    </mat-card-content>
  </mat-card>
</div>
